<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Easy Forty ‚Äî Get $40 for Joining Acorns</title>
  <meta name="description" content="Join Acorns via our trusted link, deposit $5, and get $40. Mobile-first, secure, and fast.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/styles.css">
</head>
<body>
  <header class="nav">
    <div class="brand">Easy <span>Forty</span></div>
  </header>

  <main class="container">
    <section class="hero">
      <h1>Earn $40 for joining Acorns</h1>
      <p class="sub">Scan. Sign up. Deposit $5. That‚Äôs it. We‚Äôll text you the link and instructions.</p>
      <ul class="ticks">
        <li>Minimal steps, mobile-first</li>
        <li>Real human payout via Venmo/Zelle</li>
        <li>Clear, compliant opt‚Äëin</li>
      </ul>
    </section>

    <section class="card">
      <form id="flow" novalidate>
        <div id="step1" class="step active">
          <label for="phone">Your mobile number</label>
          <input id="phone" name="phone" type="tel" inputmode="tel" placeholder="+1 555 555 5555" required>
          <div class="consent">
            <label>
              <input id="consent" type="checkbox" required>
              I consent to receive automated SMS/MMS from Easy Forty about my referral. Msg & data rates may apply. Reply STOP to opt out, HELP for help. Message frequency varies.
            </label>
          </div>
          <button type="button" id="toStep2">Continue</button>
          <p class="fineprint">By continuing you agree to our <a href="/terms.html" target="_blank" rel="noopener">Terms</a> and <a href="/privacy.html" target="_blank" rel="noopener">Privacy Policy</a>.</p>
        </div>

        <div id="step2" class="step">
          <label for="handle">Where should we send your $40? (Venmo or Zelle username)</label>
          <input id="handle" name="handle" type="text" placeholder="@your-venmo or your Zelle email/phone" required>
          <button type="submit" id="submitBtn">Get my link</button>
          <p class="fineprint">We only use this to send your payout after verification.</p>
        </div>

        <div id="done" class="step">
          <h3>Check your texts üì≤</h3>
          <p>We just sent your unique link and simple steps. After you‚Äôre done, reply ‚ÄúDONE‚Äù to the text and send a screenshot of your $5 deposit.</p>
        </div>
      </form>
    </section>

    <section class="trust">
      <div class="badges">
        <div class="badge">Secure</div>
        <div class="badge">No spam</div>
        <div class="badge">1:1 payout</div>
      </div>
      <p class="disclaimer">Acorns is a third‚Äëparty. Easy Forty is an independent promotion. Subject to Acorns terms & eligibility.</p>
    </section>
  </main>

  <footer class="footer">
    <a href="/terms.html">Terms</a>
    <a href="/privacy.html">Privacy</a>
    <a href="mailto:support@easyforty.com">Support</a>
  </footer>

  <script>
    const phoneInput = document.getElementById('phone');
    const consent = document.getElementById('consent');
    const toStep2 = document.getElementById('toStep2');
    const form = document.getElementById('flow');
    const step1 = document.getElementById('step1');
    const step2 = document.getElementById('step2');
    const done = document.getElementById('done');
    const handle = document.getElementById('handle');
    const submitBtn = document.getElementById('submitBtn');

    function validPhone(v) {
      return /^\+?[1-9]\d{6,15}$/.test(v.replace(/\s|-/g,''));
    }

    toStep2.addEventListener('click', () => {
      const p = phoneInput.value.trim();
      if (!validPhone(p)) {
        alert('Please enter a valid phone number in international format (e.g., +15555555555).');
        return;
      }
      if (!consent.checked) {
        alert('Please consent to SMS/MMS to continue.');
        return;
      }
      step1.classList.remove('active');
      step2.classList.add('active');
      handle.focus();
    });

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const p = phoneInput.value.trim().replace(/\s|-/g,'');
      const h = handle.value.trim();
      if (!h) {
        alert('Please enter your Venmo/Zelle handle.');
        return;
      }
      submitBtn.disabled = true;
      try {
        const res = await fetch('/api/submit', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ phone: p, payout_handle: h, consent: true })
        });
        if (!res.ok) {
          const j = await res.json().catch(()=>({error:'Unknown error'}));
          throw new Error(j.error || 'Something went wrong.');
        }
        step2.classList.remove('active');
        done.classList.add('active');
      } catch (err) {
        alert(err.message);
      } finally {
        submitBtn.disabled = false;
      }
    });
  </script>
</body>
</html>
